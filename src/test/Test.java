package test;

import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;

import javax.crypto.BadPaddingException;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.DESKeySpec;

import com.sun.org.apache.xerces.internal.impl.dv.util.Base64;

import util.DESdemo;

public class Test {
	public static void main(String[] args) throws InvalidKeyException, NoSuchAlgorithmException, NoSuchPaddingException, IllegalBlockSizeException, BadPaddingException, InvalidKeySpecException {
		
//		String json = "{\"n\":94398787136135578544373043553722607149819472554276185013533586405473384119697273159367000324115296839262700509398668669949008722865496691823504739745754359851249391601011745585964782915456614775789119419518288078020302402796124186810273743843335326154704940531639231184847364778383159058115855833189446792449,\"e\":65537,\"d\":36915734859880964073938946446104592804716774678327423374763145795289338260886543689845687951947006159779418517102987310101517380385428303320942413826448235204474793350449546628946948179270669293935629458426246093248411547365786602777446753862708900374522087501133036079028686126985593237972077480892205443333,\"p\":9789572088911409448069023277131290958277976824663562936555379537414888615152472544756093071975658853475024733983009652945320559785111584803477430653709011,\"q\":9642789927770237049656264298603828466068351162920266058525909673350320730128167939768198179648289559606731230981309093400974688845715348562135101238432859,\"pe\":5933164523422817389830196752485693224633432099053003949524385846561779998990741252692555607044466021637059713349789331446177466693083786996568709973989073,\"qe\":3902904399408476249739567981213133861649588521714801981605173871176443958182092295501643726648313606941546800021517692472256200258196825243132821085046157,\"coeff\":755352864446878161818767560015410760790222296204633622939418394881110122628973099211082440486164962823961680732598312880145198013601586617578912500402308,\"algid\":{\"algid\":{\"components\":[1,2,840,113549,1,1,1],\"componentLen\":7},\"constructedFromDer\":true},\"key\":[48,-126,2,91,2,1,0,2,-127,-127,0,-122,109,-89,93,-46,-40,127,-75,-75,121,-85,-28,35,-46,62,42,-127,45,62,8,-111,1,-42,-52,-22,-15,43,-80,-99,-90,-75,82,75,-66,-127,-106,-50,-83,-53,-67,-107,-107,-47,-45,13,-80,-62,-127,41,115,78,-42,-121,-108,74,101,121,13,9,69,1,-104,44,48,35,40,-91,54,-91,97,101,42,12,98,100,-95,-8,62,-96,29,118,-64,-5,72,-55,10,1,-107,-68,6,-48,-71,0,82,34,42,-52,-121,17,-44,33,15,-55,19,-20,-58,4,-100,41,-75,-11,57,120,95,-51,-84,61,21,23,2,12,-12,38,13,-107,35,53,1,2,3,1,0,1,2,-127,-128,52,-111,-37,58,-64,-62,-77,-90,-66,-46,87,27,63,-70,-17,94,-75,-25,-104,115,-57,41,93,-12,3,8,-49,90,33,60,-39,121,-42,111,40,-60,110,12,-33,57,67,-81,52,64,2,1,-106,-2,-27,-45,-41,7,-28,59,100,-96,-84,39,33,-15,-33,126,-64,0,126,22,113,-124,127,-68,-1,17,113,-5,94,-15,-29,-56,35,-76,7,-85,-41,71,115,-53,84,-10,113,74,51,-80,-119,-47,71,-66,71,-106,-75,-55,7,-97,75,-33,-101,-113,55,-75,2,-126,-127,83,-37,68,50,122,-75,37,118,115,-125,-83,72,-26,-61,-103,41,5,2,65,0,-70,-22,110,126,32,48,58,-75,-70,116,75,77,-85,-30,-9,-88,-80,32,-124,115,70,-64,67,75,-71,-107,-93,-31,-21,-128,95,-102,-125,-59,118,-73,89,-51,-89,64,121,85,-74,-62,-106,-26,-41,54,83,65,76,-23,22,-72,-81,-108,105,86,74,-68,3,-88,106,-45,2,65,0,-72,28,-7,-80,-60,57,-57,44,36,44,122,-96,95,-12,-98,-78,13,127,113,45,112,71,-42,-127,1,53,0,-25,12,84,-81,-93,-78,-22,-122,-101,-75,-30,126,-39,-1,-54,-101,-16,108,-24,38,-121,109,-32,78,84,-108,47,81,-79,112,-25,-12,-3,50,-24,84,91,2,64,113,72,-76,62,-20,-13,78,33,-26,39,-91,-100,37,-103,33,-48,-77,46,-126,23,-5,-63,123,7,-30,42,-73,112,-83,114,-40,126,-91,110,-128,77,15,-72,124,-83,-82,-36,44,48,51,-107,36,-54,96,27,43,-87,-7,-125,101,-90,-27,80,-49,106,-76,44,-42,-47,2,64,74,-124,-1,-45,58,57,32,-110,-113,57,-87,-112,-116,6,24,-51,124,-123,30,-84,3,-116,48,24,27,2,-9,16,-115,127,33,112,34,-108,-90,83,19,-11,78,-34,-79,-105,-78,50,72,2,86,-59,-18,5,33,-17,61,-29,65,47,-114,-63,115,-7,-97,-57,69,-115,2,64,14,108,22,-128,33,16,99,-65,-22,38,-1,75,22,-78,28,6,-106,50,121,57,124,103,-1,-48,83,60,34,-46,18,-56,52,19,-113,107,-5,72,66,-59,-126,58,43,-53,61,-83,-10,-54,46,-53,74,-27,34,-48,-104,12,-82,59,7,80,103,63,97,-29,-56,-124]}";
//		RSAdemo rsa = new RSAdemo();
//		RSAPrivateKey privateKey = new Gson().fromJson(json, RSAPrivateKey.class);
//		String deStr = "qP1,s?sh;gH9lRf?5+6";
//		String s = rsa.de(privateKey, deStr.getBytes());
//		System.out.println(s);
		
		String json ="RcvZLFETinM=";
//		SecretKey key = Base64.decode(json);
		DESdemo de1 = new DESdemo();
		  //实例化DES密钥规则  
        DESKeySpec dks = new DESKeySpec(Base64.decode(json));  
        //实例化密钥工厂  
        SecretKeyFactory skf = SecretKeyFactory.getInstance("DES");  
        //生成密钥  
        SecretKey  secretKey = skf.generateSecret(dks); 
		String str = "d9oumEQuBEDoHgvJcuhNxQxv/vP8RWAXhkDEEJ36pDk=";
		byte[] decryptor = de1.Decryptor(Base64.decode(str),secretKey);
		System.out.println(new String(decryptor));
	}
}
